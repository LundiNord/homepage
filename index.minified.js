let language=window.navigator.language,langData={};function updateContent(e){document.querySelectorAll("[data-lang]").forEach((t=>{const a=t.getAttribute("data-lang");t.innerHTML=e[a]}))}async function fetchLanguageData(e){return(await fetch(`/languages/${e}.json`)).json()}async function changeLanguage(){"de-DE"!==language&&"de"!==language||(langData=await fetchLanguageData("de"),updateContent(langData),umami.track("Changed language to German"))}changeLanguage();export function toggleTheme(){const e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e),updateButtonText(e),umami.track("Theme switch")}function detectSystemTheme(){const e=localStorage.getItem("theme");if(e)document.documentElement.setAttribute("data-theme",e),updateButtonText(e);else{const e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";document.documentElement.setAttribute("data-theme",e),updateButtonText(e)}}function updateButtonText(e){const t=document.querySelector(".theme-toggle");0!==Object.keys(langData).length?t.textContent="dark"===e?langData.light_mode:langData.dark_mode:t.textContent="dark"===e?"White Mode":"Dark Mode"}document.querySelector(".theme-toggle").addEventListener("click",toggleTheme),detectSystemTheme();const search=document.getElementById("search")||null,searchResults=document.getElementById("search-results")||null;try{search.addEventListener("keyup",(function(){searchAndDisplay()}))}catch{console.log("Search not available")}async function searchAndDisplay(){const e=search.value.toLowerCase();if(e.length<2)return searchResults.innerHTML="",void(searchResults.style.display="none");fulltextSearch(e).then((e=>{searchResults.innerHTML="",0===(e=e.filter(((e,t,a)=>t===a.findIndex((t=>t.url===e.url))))).length?searchResults.style.display="none":searchResults.style.display="block";for(let t=0;t<e.length;t++){const a=e[t];if(0!==t){const e=document.createElement("div");e.innerHTML="------------",searchResults.appendChild(e)}const n=document.createElement("div");n.innerHTML=`<a href="${a.url}">${a.text}</a>`,searchResults.appendChild(n)}})),umami.track("Search",{search_data:e})}const searchablePages=[];async function fetchPage(){const e=["/hiking/sweden2024.html","/hiking/norwaySweden2023.html","/hiking/mapViewer.html","/hiking.html","/index.html","/privacy.html","/hiking/norway2021.html"];for(const t of e)try{const e=await fetch(t),a=await e.text(),n=(new DOMParser).parseFromString(a,"text/html");searchablePages.push([n,t])}catch(e){console.error(`Error parsing ${t}:`,e)}}async function fulltextSearch(e){0===searchablePages.length&&await fetchPage();let t=[];for(const a of searchablePages)try{const n=await recursiveSearch(a[0].getRootNode(),e,a[1]);t=t.concat(n)}catch(e){console.error(`Error searching ${a[1]}:`,e)}return t}async function recursiveSearch(e,t,a){let n=[],c="";try{c=e.childNodes[0].nodeValue}catch(t){c=e.textContent}if(c&&c.toLowerCase().includes(t)){let t=e;for(;t&&!t.id;){if(null===t.parentNode){n.push({id:"",url:`${a}`,text:c.trim()});break}t=t.parentNode}t&&t.id&&n.push({id:t.id,url:`${a}#${t.id}`,text:c.trim()})}if(e.childNodes&&e.childNodes.length>0)for(const c of e.childNodes)if("script"!==c.nodeName.toLowerCase()){const e=await recursiveSearch(c,t,a);n=n.concat(e)}return n}